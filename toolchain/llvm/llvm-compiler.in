#!/bin/sh
PROG=@CMAKE_INSTALL_PREFIX@/bin/@clang_compiler@
TARGET=@TARGET_ARCH@
FLAGS="$FLAGS -target $TARGET -march=@GCC_ARCH@ -mtune=@M_TUNE@"
FLAGS="$FLAGS @driver_mode@ --sysroot @MINGW_INSTALL_PREFIX@"
FLAGS="$FLAGS -fuse-ld=lld --ld-path=@TARGET_ARCH@-ld"
FLAGS="$FLAGS @cfi@ @opt@"
FLAGS="$FLAGS -gcodeview"
FLAGS="$FLAGS -Wno-unused-command-line-argument"
SECTION="-fdata-sections -ffunction-sections"

if [ "$CONF" == "1" ]; then
    SKIP_OPT="-O0 -fno-lto"
fi

if [ "$NO_SECTION" == "1" ]; then
    unset SECTION
fi

"$PROG" "$@" $FLAGS @CLANG_FLAGS@ @linker@ $SECTION $SKIP_OPT
