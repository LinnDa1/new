#!/bin/sh
PROG=@CMAKE_INSTALL_PREFIX@/bin/ld.lld
TARGET=@TARGET_ARCH@
FLAGS="-m @ld_m_flag@"
FLAGS="$FLAGS @opt@"
FLAGS="$FLAGS --pdb="
FLAGS="$FLAGS -O3 -Xlink=-opt:lldlto=3 -Xlink=-opt:lldltocgo=3"
SECTION="--gc-sections -Xlink=-opt:safeicf"

if [ "$CONF" == "1" ]; then
    SKIP_OPT="-O0 -Xlink=-opt:lldlto=0 -Xlink=-opt:lldltocgo=0 --no-gc-sections --no-guard-cf"
fi

if [ "$NO_SECTION" == "1" ]; then
    unset SECTION
fi

"$PROG" "$@" $FLAGS @LLD_FLAGS@ $SECTION $SKIP_OPT
